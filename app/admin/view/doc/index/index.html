<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>

<meta name="viewport"content="user-scalable=no, width=device-width">
<meta name="viewport"content="width=device-width, initial-scale=1"/>
<meta name="renderer"content="webkit">
<link rel="stylesheet" href="//cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css" />

<link rel="stylesheet" href="//cdn.staticfile.org/twitter-bootstrap/3.4.1/css/bootstrap.min.css" type="text/css" />

<script src="//cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="//cdn.staticfile.org/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script src="//cdn.staticfile.org/jquery-ujs/1.2.2/rails.min.js"async="true"></script>

</head>
<body>

<div id="ielt9"style="height:100%">
<style type="text/css">
body{color:#000;}header { position: relative; }
.bann{ content:'';background-size:100%;background:#4280cb;background:-webkit-gradient(linear,0 0,0 100%,from(#4585d2),to(#4280cb));background:-moz-linear-gradient(top,#4585d2,#4280cb);background:linear-gradient(to bottom,#4585d2,#4280cb);top:0;left:0;z-index:-1;min-height:50px;width:100%}.fl .active{ color:#3F5061;background:#fff;border-color:#fff}
.api_block{margin-bottom: 4em;}
</style>

<div class="bann">


<div class="col-xs-12"style="text-align:center;">
<div class="h3"style="color:#ffffff;margin-top: 35px;margin-bottom: 30px;">开发文档</div>
                  
<div style="clear:both;"></div>
</div><div style="clear:both;"></div>
</div>


<div class="container">

  <!-- Docs nav
  ================================================== -->
  <div class="row">
    <div class="col-md-3 ">
      <div id="toc" class="bc-sidebar">
		<ul class="nav">
			<hr/>
			<li class="toc-h2"><a href="#pay0">拉起支付</a></li>
			<li class="toc-h2"><a href="#pay2">支付结果通知</a></li>
			<li class="toc-h2"><a href="#pay3">MD5签名算法</a></li>
      <li class="toc-h2"><a href="#pay4">支付方式列表</a></li>
     
		</ul>
	</div>
   </div>

    <div class="col-md-9">
      <article class="post page">
      	<section class="post-content">
		<hr/>
<div id="toc2" class="api_block">
			<h3>
				协议规则
			</h3>
			<p>传输方式：HTTP</p>
			<p>数据格式：JSON</p>
			<p>签名算法：MD5</p>
			<p>字符编码：UTF-8</p>
		</div>
		<div id="pay0" class="api_block">
			<h3>
				拉起支付
			</h3>
			<p>【方式一】页面跳转支付地址：<font color="#29389f">【GET】{$domain}/api/submit</font></p>
            <p><font color="#777">此接口可用于用户前台直接发起支付，使用form表单跳转或拼接成url访问跳转。</font></p>
            <p>【方式二】API获取支付链接地址：<font color="#29389f">【POST】{$domain}//api/submit_api</font></p>
            <p><font color="#777">此接口用于后端访问接口,获取支付链接提供给用户跳转。</font></p>
<p>提交参数数据：<font color="#29389f">pid={商户ID}&amp;type={支付方式}&amp;out_trade_no={商户订单号}&amp;notify_url={服务器异步通知地址}&amp;return_url={页面跳转通知地址}&amp;name={商品名称}&amp;money={金额}&amp;sign={签名字符串}&amp;sign_type=MD5</font></p>
<p>请求参数说明：</p>
<table class="table table-bordered table-hover">
  <thead><tr><th>字段名</th><th>变量名</th><th>必填</th><th>类型</th><th>示例值</th><th>描述</th></tr></thead>
  <tbody>
  <tr><td>商户ID</td><td>pid</td><td>是</td><td>Int</td><td>10001</td><td></td></tr>
  <tr><td>支付方式</td><td>type</td><td>是</td><td>String</td><td>alipay</td><td><a href="#pay4" style="color:#4585d2">支付方式列表</a></td></tr>
  <tr><td>商户订单号</td><td>out_trade_no</td><td>是</td><td>String</td><td>20160806151343349</td><td></td></tr>
  <tr><td>异步通知地址</td><td>notify_url</td><td>是</td><td>String</td><td>http://www.pay.com/notify_url.php</td><td>服务器异步通知地址</td></tr>
  <tr><td>跳转通知地址</td><td>return_url</td><td>是</td><td>String</td><td>http://www.pay.com/return_url.php</td><td>页面跳转通知地址</td></tr>
  <tr><td>商品名称</td><td>name</td><td>是</td><td>String</td><td>VIP会员</td><td></td></tr>
  <tr><td>商品金额</td><td>money</td><td>是</td><td>String</td><td>1.00</td><td></td></tr>
  <tr><td>业务扩展参数</td><td>param</td><td>否</td><td>String</td><td>没有请留空</td><td>支付后原样返回</td></tr>
  <tr><td>签名字符串</td><td>sign</td><td>是</td><td>String</td><td>202cb962ac59075b964b07152d234b70</td><td>签名算法<a href="https://opendocs.alipay.com/open/common/104741" target="_blank" style="color:#4585d2">点此查看</a></td></tr>
  <tr><td>签名类型</td><td>sign_type</td><td>是</td><td>String</td><td>MD5</td><td>默认为MD5</td></tr>
  </tbody>
</table>
<p>返回结果（json格式,仅在【方式二】下返回）：</p>
<table class="table table-bordered table-hover">
  <thead><tr><th>字段名</th><th>变量名</th><th>类型</th><th>示例值</th><th>描述</th></tr></thead>
  <tbody>
  <tr><td>返回状态码</td><td>code</td><td>Int</td><td>200</td><td>200为成功，其它值为失败</td></tr>
  <tr><td>返回信息</td><td>msg</td><td>String</td><td>获取支付链接成功</td><td>失败时返回原因</td></tr>

  <tr><td>支付跳转url</td><td>url</td><td>String</td><td>{$domain}//api/pay/202010903/</td><td>仅在code=200时返回该字段，则直接跳转到该url支付</td></tr>

  </tbody>
</table>
		</div>

		<div id="pay2" class="api_block">
			<h3>
				支付结果通知
			</h3>
<p>通知类型：服务器异步通知（notify_url）、页面跳转通知（return_url）</p>
<p>请求方式：异步通知为POST   跳转通知为GET</p>
<p>请求参数说明：</p>
<table class="table table-bordered table-hover">
  <thead><tr><th>字段名</th><th>变量名</th><th>必填</th><th>类型</th><th>示例值</th><th>描述</th></tr></thead>
  <tbody>
  <tr><td>商户ID</td><td>pid</td><td>是</td><td>Int</td><td>1001</td><td></td></tr>
  <tr><td>易支付订单号</td><td>trade_no</td><td>是</td><td>String</td><td>20160806151343349021</td><td>易支付订单号</td></tr>
  <tr><td>商户订单号</td><td>out_trade_no</td><td>是</td><td>String</td><td>20160806151343349</td><td>商户系统内部的订单号</td></tr>
  <tr><td>支付方式</td><td>type</td><td>是</td><td>String</td><td>alipay</td><td><a href="#pay4" style="color:#4585d2">支付方式列表</a></td></tr>
  <tr><td>商品名称</td><td>name</td><td>是</td><td>String</td><td>VIP会员</td><td></td></tr>
  <tr><td>商品金额</td><td>money</td><td>是</td><td>String</td><td>1.00</td><td></td></tr>
  <tr><td>支付状态</td><td>trade_status</td><td>是</td><td>String</td><td>TRADE_SUCCESS</td><td>只有TRADE_SUCCESS是成功</td></tr>
  <tr><td>业务扩展参数</td><td>param</td><td>否</td><td>String</td><td></td><td></td></tr>
  <tr><td>签名字符串</td><td>sign</td><td>是</td><td>String</td><td>202cb962ac59075b964b07152d234b70</td><td>签名算法与<a href="https://doc.open.alipay.com/docs/doc.htm?treeId=62&articleId=104741&docType=1" target="_blank">支付宝签名算法</a>相同</td></tr>
  <tr><td>签名类型</td><td>sign_type</td><td>是</td><td>String</td><td>MD5</td><td>默认为MD5</td></tr>
  </tbody>
</table>
<p><font color="#993939">收到异步通知后，需返回success以表示服务器接收到了订单通知 如 echo 'success'; 或 return exit var_dump;</font></p>
		</div>
		<div id="pay3" class="api_block">
			<h3>
				MD5签名算法
			</h3>
<p>
    请对参数按照键名进行降序排序（a-z），sign sign_type 和空值不进行签名！。
    排序后请操作参数生成或拼接一个url请求字符串 例如 <code>a=b&amp;c=d&amp;e=f</code> (Url值不能携带参数！不要进行urlencode)
    再将拼接好的请求字符串与平台生成的Key进行MD5加密得出sign签名参数  <code>md5 ( a=b&amp;c=d&amp;e=f + KEY )</code> (注意：+ 为各语言的拼接符！不是字符！)，md5为小写
</p>
		</div>
    <div id="pay4" class="api_block">
			<h3>
				支付方式列表
			</h3>
<table class="table table-bordered table-hover">
  <thead><tr><th>调用值</th><th>显示名称</th></tr></thead>
  <tbody>
<tr><td>alipay</td><td>支付宝</td></tr><tr><td>wxpay</td><td>微信支付</td></tr> </tbody>
</table>

	
          </section>
      </article>
    </div>
  </div>

</div>


</div>
</body>
</html> 